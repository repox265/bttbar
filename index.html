<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BTTools v3 - Barcode Tools</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 0;
      color: #333;
    }

    .container {
      max-width: 100%;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .header {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      padding: 1rem;
      text-align: center;
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .brand {
      font-size: 1.5rem;
      font-weight: 800;
      background: linear-gradient(135deg, #667eea, #764ba2);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .subtitle {
      font-size: 0.875rem;
      color: #64748b;
      margin-top: 0.25rem;
    }

    .main-content {
      flex: 1;
      padding: 1rem;
    }

    .tab-navigation {
      display: flex;
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      padding: 4px;
      margin-bottom: 1rem;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    }

    .tab-btn {
      flex: 1;
      padding: 0.75rem 0.5rem;
      border: none;
      background: transparent;
      color: #64748b;
      font-weight: 600;
      font-size: 0.875rem;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      text-align: center;
    }

    .tab-btn.active {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      transform: translateY(-1px);
      box-shadow: 0 4px 16px rgba(102, 126, 234, 0.4);
    }

    .tab-content {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 1.5rem;
      box-shadow: 0 12px 40px rgba(0, 0, 0, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .form-grid {
      display: grid;
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .form-group {
      display: flex;
      flex-direction: column;
    }

    .form-label {
      font-size: 0.875rem;
      font-weight: 600;
      color: #475569;
      margin-bottom: 0.5rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .form-input {
      padding: 1rem;
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      font-size: 1rem;
      transition: all 0.3s ease;
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(5px);
    }

    .form-input:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      transform: translateY(-1px);
    }

    .form-input:invalid {
      border-color: #ef4444;
      box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
    }

    .action-btn {
      width: 100%;
      padding: 1rem;
      border: none;
      border-radius: 16px;
      font-size: 1rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      box-shadow: 0 4px 16px rgba(102, 126, 234, 0.3);
      position: relative;
      overflow: hidden;
    }

    .action-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.5s;
    }

    .action-btn:hover::before {
      left: 100%;
    }

    .action-btn:active {
      transform: translateY(1px);
    }

    .result-panel {
      margin-top: 1rem;
      padding: 1rem;
      background: linear-gradient(135deg, #1e293b, #334155);
      color: #e2e8f0;
      border-radius: 12px;
      font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
      font-size: 0.875rem;
      line-height: 1.6;
      box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.2);
      word-break: break-all;
    }

    .barcode-container {
      margin-top: 1rem;
      text-align: center;
    }

    .barcode-image {
      max-width: 100%;
      height: auto;
      border-radius: 12px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
      background: white;
      padding: 1rem;
    }

    .hidden {
      display: none !important;
    }

    .icon {
      width: 1.25rem;
      height: 1.25rem;
      fill: currentColor;
    }

    /* Mobile optimizations */
    @media (max-width: 480px) {
      .tab-btn {
        font-size: 0.75rem;
        padding: 0.625rem 0.375rem;
      }
      
      .tab-content {
        padding: 1rem;
      }
      
      .form-input {
        font-size: 16px; /* Prevents zoom on iOS */
      }
    }

    /* Landscape mobile optimization */
    @media (max-height: 500px) and (orientation: landscape) {
      .header {
        padding: 0.5rem;
      }
      
      .main-content {
        padding: 0.5rem;
      }
      
      .tab-content {
        padding: 1rem;
      }
    }

    /* Animation for tab switching */
    .tab-panel {
      animation: fadeIn 0.3s ease-in-out;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .pulse {
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% {
        opacity: 1;
      }
      50% {
        opacity: 0.7;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header class="header">
      <div class="brand">BTTools v3</div>
      <div class="subtitle">Advanced Barcode Tools</div>
    </header>

    <main class="main-content">
      <nav class="tab-navigation">
        <button class="tab-btn active" data-tab="find-offset">
          <svg class="icon" viewBox="0 0 24 24">
            <path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" />
          </svg>
          Find Offset
        </button>
        <button class="tab-btn" data-tab="check-offset">
          <svg class="icon" viewBox="0 0 24 24">
            <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" />
          </svg>
          Check
        </button>
        <button class="tab-btn" data-tab="generate">
          <svg class="icon" viewBox="0 0 24 24">
            <path d="M3,4V6H21V4H3M3,11H21V9H3V11M3,18H21V16H3V18Z" />
          </svg>
          Generate
        </button>
      </nav>

      <!-- Find Effective Offset Tab -->
      <div class="tab-content tab-panel" id="find-offset">
        <div class="form-grid">
          <div class="form-group">
            <label class="form-label">
              <svg class="icon" viewBox="0 0 24 24">
                <path d="M12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22C6.47,22 2,17.5 2,12A10,10 0 0,1 12,2M12.5,7V12.25L17,14.92L16.25,16.15L11,13V7H12.5Z" />
              </svg>
              Time 1 (HHMMSS)
            </label>
            <input type="text" class="form-input" id="time1" placeholder="123456" maxlength="6" pattern="[0-9]{6}">
          </div>
          <div class="form-group">
            <label class="form-label">
              <svg class="icon" viewBox="0 0 24 24">
                <path d="M3,4V6H21V4H3M3,11H21V9H3V11M3,18H21V16H3V18Z" />
              </svg>
              Code 1
            </label>
            <input type="number" class="form-input" id="code1" placeholder="Enter code">
          </div>
          <div class="form-group">
            <label class="form-label">
              <svg class="icon" viewBox="0 0 24 24">
                <path d="M12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22C6.47,22 2,17.5 2,12A10,10 0 0,1 12,2M12.5,7V12.25L17,14.92L16.25,16.15L11,13V7H12.5Z" />
              </svg>
              Time 2 (HHMMSS)
            </label>
            <input type="text" class="form-input" id="time2" placeholder="123456" maxlength="6" pattern="[0-9]{6}">
          </div>
          <div class="form-group">
            <label class="form-label">
              <svg class="icon" viewBox="0 0 24 24">
                <path d="M3,4V6H21V4H3M3,11H21V9H3V11M3,18H21V16H3V18Z" />
              </svg>
              Code 2
            </label>
            <input type="number" class="form-input" id="code2" placeholder="Enter code">
          </div>
        </div>
        <button class="action-btn" onclick="findEffectiveOffset()">Find Effective Offset</button>
        <div id="result1" class="result-panel hidden"></div>
      </div>

      <!-- Check Known Offset Tab -->
      <div class="tab-content tab-panel hidden" id="check-offset">
        <div class="form-grid">
          <div class="form-group">
            <label class="form-label">
              <svg class="icon" viewBox="0 0 24 24">
                <path d="M12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22C6.47,22 2,17.5 2,12A10,10 0 0,1 12,2M12.5,7V12.25L17,14.92L16.25,16.15L11,13V7H12.5Z" />
              </svg>
              Time (HHMMSS)
            </label>
            <input type="text" class="form-input" id="timeKnown" placeholder="123456" maxlength="6" pattern="[0-9]{6}">
          </div>
          <div class="form-group">
            <label class="form-label">
              <svg class="icon" viewBox="0 0 24 24">
                <path d="M3,4V6H21V4H3M3,11H21V9H3V11M3,18H21V16H3V18Z" />
              </svg>
              Code
            </label>
            <input type="number" class="form-input" id="codeKnown" placeholder="Enter code">
          </div>
          <div class="form-group">
            <label class="form-label">
              <svg class="icon" viewBox="0 0 24 24">
                <path d="M12,6A3,3 0 0,0 9,9A3,3 0 0,0 12,12A3,3 0 0,0 15,9A3,3 0 0,0 12,6M6,8.5A1.5,1.5 0 0,1 7.5,7A1.5,1.5 0 0,1 9,8.5A1.5,1.5 0 0,1 7.5,10A1.5,1.5 0 0,1 6,8.5M18,8.5A1.5,1.5 0 0,1 16.5,10A1.5,1.5 0 0,1 15,8.5A1.5,1.5 0 0,1 16.5,7A1.5,1.5 0 0,1 18,8.5Z" />
              </svg>
              Effective Offset
            </label>
            <input type="number" class="form-input" id="offsetKnown" placeholder="Enter offset">
          </div>
        </div>
        <button class="action-btn" onclick="checkOffset()">Check Offset</button>
        <div id="result2" class="result-panel hidden"></div>
      </div>

      <!-- Generate Barcode Tab -->
      <div class="tab-content tab-panel hidden" id="generate">
        <div class="form-grid">
          <div class="form-group">
            <label class="form-label">
              <svg class="icon" viewBox="0 0 24 24">
                <path d="M12,6A3,3 0 0,0 9,9A3,3 0 0,0 12,12A3,3 0 0,0 15,9A3,3 0 0,0 12,6Z" />
              </svg>
              Segment 1
            </label>
            <input type="text" class="form-input" id="seg1" placeholder="Enter seg1">
          </div>
          <div class="form-group">
            <label class="form-label">
              <svg class="icon" viewBox="0 0 24 24">
                <path d="M12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22C6.47,22 2,17.5 2,12A10,10 0 0,1 12,2M12.5,7V12.25L17,14.92L16.25,16.15L11,13V7H12.5Z" />
              </svg>
              Time (HHMMSS)
            </label>
            <input type="text" class="form-input" id="timeGen" placeholder="123456" maxlength="6" pattern="[0-9]{6}">
          </div>
          <div class="form-group">
            <label class="form-label">
              <svg class="icon" viewBox="0 0 24 24">
                <path d="M12,6A3,3 0 0,0 9,9A3,3 0 0,0 12,12A3,3 0 0,0 15,9A3,3 0 0,0 12,6M6,8.5A1.5,1.5 0 0,1 7.5,7A1.5,1.5 0 0,1 9,8.5A1.5,1.5 0 0,1 7.5,10A1.5,1.5 0 0,1 6,8.5M18,8.5A1.5,1.5 0 0,1 16.5,10A1.5,1.5 0 0,1 15,8.5A1.5,1.5 0 0,1 16.5,7A1.5,1.5 0 0,1 18,8.5Z" />
              </svg>
              Effective Offset
            </label>
            <input type="tel" class="form-input" id="offsetGen" placeholder="Enter offset" inputmode="numeric">
          </div>
          <div class="form-group">
            <label class="form-label">
              <svg class="icon" viewBox="0 0 24 24">
                <path d="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z" />
              </svg>
              Segment 5 (Cashier ID)
            </label>
            <input type="text" class="form-input" id="seg5" placeholder="Cashier ID">
          </div>
          <div class="form-group">
            <label class="form-label">
              <svg class="icon" viewBox="0 0 24 24">
                <path d="M12,6A3,3 0 0,0 9,9A3,3 0 0,0 12,12A3,3 0 0,0 15,9A3,3 0 0,0 12,6Z" />
              </svg>
              Segment 6
            </label>
            <input type="text" class="form-input" id="seg6" placeholder="Enter seg6">
          </div>
        </div>
        <button class="action-btn" onclick="generateBarcode()">Generate Barcode</button>
        <div id="result3" class="result-panel hidden"></div>
        <div class="barcode-container">
          <img id="barcodeImg" class="barcode-image hidden" alt="Generated Barcode">
        </div>
      </div>
    </main>
  </div>

  <script>
    // Tab switching functionality
    const tabButtons = document.querySelectorAll('.tab-btn');
    const tabPanels = document.querySelectorAll('.tab-content');

    tabButtons.forEach(button => {
      button.addEventListener('click', () => {
        const targetTab = button.dataset.tab;
        
        // Remove active class from all buttons
        tabButtons.forEach(btn => btn.classList.remove('active'));
        // Add active class to clicked button
        button.classList.add('active');
        
        // Hide all panels
        tabPanels.forEach(panel => panel.classList.add('hidden'));
        // Show target panel
        document.getElementById(targetTab).classList.remove('hidden');
      });
    });

    // Utility functions
    function parseTime(str) {
      if (!str) return null;
      const s = str.trim();
      if (!/^\d{6}$/.test(s)) return null;
      return {
        H: +s.slice(0, 2),
        M: +s.slice(2, 4),
        S: +s.slice(4, 6)
      };
    }

    function toSeconds(t) {
      return t.H * 3600 + t.M * 60 + t.S;
    }

    function showResult(elementId, content, isError = false) {
      const element = document.getElementById(elementId);
      element.textContent = content;
      element.classList.remove('hidden');
      element.style.background = isError 
        ? 'linear-gradient(135deg, #dc2626, #b91c1c)' 
        : 'linear-gradient(135deg, #1e293b, #334155)';
    }

    function prefillGenerator(time, offset) {
      document.getElementById('timeGen').value = 
        `${String(time.H).padStart(2, '0')}${String(time.M).padStart(2, '0')}${String(time.S).padStart(2, '0')}`;
      document.getElementById('offsetGen').value = offset;
      
      // Switch to generator tab
      document.querySelector('[data-tab="generate"]').click();
    }

    // Tab 1: Find Effective Offset
    function findEffectiveOffset() {
      const t1 = parseTime(document.getElementById('time1').value);
      const c1 = +document.getElementById('code1').value.trim();
      const t2 = parseTime(document.getElementById('time2').value);
      const c2 = +document.getElementById('code2').value.trim();

      if (!t1 || !t2 || isNaN(c1) || isNaN(c2)) {
        showResult('result1', 'Please fill all fields with valid values', true);
        return;
      }

      const s1 = toSeconds(t1);
      const s2 = toSeconds(t2);
      const off1 = c1 - s1;
      const off2 = c2 - s2;

      if (off1 !== off2) {
        showResult('result1', `⚠️ Offsets differ!\nOffset 1: ${off1}\nOffset 2: ${off2}`, true);
      } else {
        showResult('result1', `✅ Effective Offset Found: ${off1}`);
        prefillGenerator(t2, off1);
      }
    }

    // Tab 2: Check Known Offset
    function checkOffset() {
      const t = parseTime(document.getElementById('timeKnown').value);
      const c = +document.getElementById('codeKnown').value.trim();
      const off = +document.getElementById('offsetKnown').value.trim();

      if (!t || isNaN(c) || isNaN(off)) {
        showResult('result2', 'Please fill all fields with valid values', true);
        return;
      }

      const s = toSeconds(t);
      const diff = c - s;
      const isMatch = diff === off;

      showResult('result2', 
        `${isMatch ? '✅' : '❌'} Offset Check\nCalculated difference: ${diff}\nExpected offset: ${off}\nResult: ${isMatch ? 'MATCH' : 'NO MATCH'}`,
        !isMatch
      );

      if (isMatch) {
        prefillGenerator(t, off);
      }
    }

    // Tab 3: Generate Barcode
    function generateBarcode() {
      const seg1 = document.getElementById('seg1').value.trim();
      const t = parseTime(document.getElementById('timeGen').value);
      const off = +document.getElementById('offsetGen').value.trim();
      const seg5 = document.getElementById('seg5').value.trim();
      const seg6 = document.getElementById('seg6').value.trim();

      if (!t || isNaN(off)) {
        showResult('result3', 'Please provide valid time and offset values', true);
        return;
      }

      const s = toSeconds(t);
      const seg2 = s + off;
      const seg3 = '000';
      const hh = String(t.H);
      const mm = String(t.M).padStart(2, '0');
      const ss = String(t.S).padStart(2, '0');
      const seg4 = (hh + mm + ss).replace(/^0+/, '');
      const fullCode = seg1 + String(seg2).padStart(6, '0') + seg3 + seg4 + seg5 + seg6;

      showResult('result3', `Generated Code: ${fullCode}`);

      // Generate and display barcode
      const barcodeImg = document.getElementById('barcodeImg');
      barcodeImg.src = `https://barcode.orcascan.com/?type=code128&data=${encodeURIComponent(fullCode)}`;
      barcodeImg.classList.remove('hidden');
      
      // Add loading animation
      barcodeImg.classList.add('pulse');
      barcodeImg.onload = () => {
        barcodeImg.classList.remove('pulse');
      };
    }

    // Copy barcode number to clipboard
    function copyBarcodeNumber() {
      copyToClipboard(generatedBarcodeCode, true);
    }

    // Copy to clipboard utility function
    function copyToClipboard(text, showFeedback = true) {
      if (!text) return;

      if (navigator.clipboard && window.isSecureContext) {
        navigator.clipboard.writeText(text).then(() => {
          if (showFeedback) {
            showCopySuccess();
          }
        }).catch(() => {
          fallbackCopyTextToClipboard(text, showFeedback);
        });
      } else {
        fallbackCopyTextToClipboard(text, showFeedback);
      }
    }

    // Fallback copy method for older browsers
    function fallbackCopyTextToClipboard(text, showFeedback) {
      const textArea = document.createElement("textarea");
      textArea.value = text;
      textArea.style.position = "fixed";
      textArea.style.left = "-999999px";
      textArea.style.top = "-999999px";
      document.body.appendChild(textArea);
      textArea.focus();
      textArea.select();
      
      try {
        document.execCommand('copy');
        if (showFeedback) {
          showCopySuccess();
        }
      } catch (err) {
        console.error('Fallback: Oops, unable to copy', err);
      }
      
      document.body.removeChild(textArea);
    }

    // Show copy success feedback
    function showCopySuccess() {
      const copyBtn = document.querySelector('.copy-btn');
      const originalHTML = copyBtn.innerHTML;
      
      copyBtn.classList.add('copy-success');
      copyBtn.innerHTML = `
        <svg class="icon" viewBox="0 0 24 24">
          <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" />
        </svg>
        Copied!
      `;
      
      setTimeout(() => {
        copyBtn.classList.remove('copy-success');
        copyBtn.innerHTML = originalHTML;
      }, 2000);
    }

    // Download barcode as PNG
    function downloadBarcode() {
      const barcodeImg = document.getElementById('barcodeImg');
      
      if (!barcodeImg.src || barcodeImg.src === '') {
        alert('No barcode to download');
        return;
      }

      // Create a canvas to convert the image
      const canvas = document.createElement('canvas');
      const ctx = canvas.getContext('2d');
      
      // Create a new image element
      const img = new Image();
      img.crossOrigin = 'anonymous';
      
      img.onload = function() {
        // Set canvas dimensions to match image
        canvas.width = img.width;
        canvas.height = img.height;
        
        // Fill white background
        ctx.fillStyle = 'white';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        
        // Draw the barcode image
        ctx.drawImage(img, 0, 0);
        
        // Convert canvas to blob
        canvas.toBlob(function(blob) {
          // Create download link
          const url = URL.createObjectURL(blob);
          const link = document.createElement('a');
          link.href = url;
          link.download = `barcode_${generatedBarcodeCode}_${new Date().getTime()}.png`;
          
          // Trigger download
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
          
          // Clean up
          URL.revokeObjectURL(url);
        }, 'image/png');
      };
      
      img.onerror = function() {
        // If CORS fails, try alternative method
        downloadBarcodeAlternative();
      };
      
      img.src = barcodeImg.src;
    }

    // Alternative download method
    function downloadBarcodeAlternative() {
      const barcodeImg = document.getElementById('barcodeImg');
      const link = document.createElement('a');
      link.href = barcodeImg.src;
      link.download = `barcode_${generatedBarcodeCode}_${new Date().getTime()}.png`;
      link.target = '_blank';
      
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }

    // Auto-format time inputs
    document.querySelectorAll('input[placeholder*="HHMMSS"]').forEach(input => {
      input.addEventListener('input', function(e) {
        let value = e.target.value.replace(/\D/g, '');
        if (value.length > 6) value = value.substring(0, 6);
        e.target.value = value;
      });
    });

    // Add haptic feedback for mobile devices
    if ('vibrate' in navigator) {
      document.querySelectorAll('button').forEach(button => {
        button.addEventListener('click', () => {
          navigator.vibrate(50);
        });
      });
    }

    // Prevent zoom on double tap for iOS
    let lastTouchEnd = 0;
    document.addEventListener('touchend', function (event) {
      const now = (new Date()).getTime();
      if (now - lastTouchEnd <= 300) {
        event.preventDefault();
      }
      lastTouchEnd = now;
    }, false);
  </script>
</body>
</html>